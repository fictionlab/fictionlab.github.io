---
title: Rapha Rover specification
sidebar_label: Specification
sidebar_position: 2
keywords:
  - rapha
  - rover
  - mobile
  - robot
  - specification
description:
  Rapha Rover is a research-ready platform designed to streamline development of
  various robotic projects, including inspection, agriculture, construction, and
  more.
image: /img/robots/rapha/rapha-rover.webp
toc_max_heading_level: 4
---

import styles from './styles.module.css';
import useBaseUrl from '@docusaurus/useBaseUrl';
import ThemedImageZoom from '@site/src/components/ThemedImageZoom';

:::warning

Rapha Rover is currently in development; therefore, the specifications are
subject to change.

:::

<ThemedImageZoom
  loading="eager"
  alt="Rapha Rover logo"
  sources={{
    light: useBaseUrl('/img/robots/rapha/rapha-logo-light.webp'),
    dark: useBaseUrl('/img/robots/rapha/rapha-logo-dark.webp'),
  }}
  width="2000"
  height="521"
  figStyle={{
    width: 600,
  }}
/>

<div style={{
    width: '100%',
    textAlign: 'center',
    paddingBottom: 20
}}>

# Beta specification

</div>

<ImageZoom
  loading="eager"
  src="/img/robots/rapha/rapha-rover.webp"
  alt="Render of beta version of Rapha Rover"
  width="2000"
  height="1500"
  figStyle={{
    width: 500,
    paddingBottom: 100,
  }}
/>

Rapha Rover is a research-ready platform designed to streamline development of
various robotic projects, including inspection, agriculture, construction, and
more. It is built to seamlessly integrate with custom payloads and operate in
diverse environments, catering to both indoor and outdoor applications (please
note that the beta version is currently limited to indoor use only).

---

## Rapha Rover introduction

### What's included

- 1 x Beta version of Rapha Rover
- 1 x Battery charger
- 2 x 24V battery pack
- 1 x Additional mounting plate
- 1 x Extended additional mounting plate

### Main parameters

| Parameter                    |             Value              |
| :--------------------------- | :----------------------------: |
| Dimensions (LxWxH)           |    556 mm x 472 mm x 282 mm    |
| Weight                       |             ~15 kg             |
| Maximum payload              |            ~10 kg\*            |
| Maximum linear speed         |            ~1.8 m/s            |
| Maximum angular speed        |           ~4.7 Rad/s           |
| Estimated max. obstacle size |             ~100 m             |
| IP protection rating         |      IP 54 (not in beta)       |
| Operating temperature        |        -10 °C to +40 °C        |
| Run time                     | up to 4 hours with 2 batteries |
| Connection range             |          Up to 100 m           |

\* - on flat terrain

#### Traction parameters

| Parameter                     |    Value    |
| :---------------------------- | :---------: |
| Track Width                   |   385 mm    |
| Wheelbase length              |   379 mm    |
| Ground clearance              |   105 mm    |
| Climb grade (no payload)      | 30° ( ~58%) |
| Climb grade with 5kg payload  | 20° ( ~36%) |
| Climb grade with 10kg payload | 10° ( ~18%) |
| Hill grade traversal          | 30° ( ~58%) |
| Nominal torque                |    4 Nm     |
| Maximum torque                |    8 Nm     |

### Rover overview

<ThemedImageZoom
  alt="Overview of main features of Rapha Rover"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-overview-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-overview-dark.webp',
    ),
  }}
  width="2000"
  height="2200"
  figStyle={{
    width: 800,
  }}
  caption="Rapha Rover overview"
/>

## Hardware specification

### Rover dimensions

<ThemedImageZoom
  alt="Main dimensions of Rapha Rover"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-dimensions-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-dimensions-dark.webp',
    ),
  }}
  width="2000"
  height="2600"
  caption="Rapha Rover dimensions"
/>

### Components

|                Name | Quantity | Description                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------: | :------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|   Built-in computer |    1     | UPBoard 7000 - third-generation credit card-sized developer board in the UP Board series.- Processor: Intel® N100 quad-core processor. <br /> <br /> Key features: <br /> - Processor: Intel® N100 quad-core processor. <br /> - Memory: 8GB LPDDR5 system memory. <br /> - Storage: 64GB eMMC storage. <br /> - Connectivity: 1 Gigabit LAN, HDMI 1.4b, 3 USB 3.2 Gen 2, 2 USB 2.0/UART, 40-pin GPIO header. |
|              Router |    1     | Teltonika RUTX10 (With RUTX11 as option after beta). Router that combines the best of wired and wireless routing functionalities with Gigabit Ethernet, Bluetooth LE, and AC Wi-Fi.                                                                                                                                                                                                                             |
|             Antenna |    2     | Dual-band (2.4 GHz / 5 GHz) placed on the rear of the robot.                                                                                                                                                                                                                                                                                                                                                    |
| Stereoscopic camera |    1     | Luxonis OAK-D Pro W is a wide-angle camera with active stereo depth and high-resolution color capabilities. It includes on-device neural network inference, computer vision features, and night vision for low-light environments.                                                                                                                                                                              |
|               Lidar |    1     | RPLidar S3 - 360-degree waterproof 2D Lidar scanner with a 40-meter range. It ensures stable performance in diverse conditions, making it suitable for both indoor and outdoor use. Operating at 10Hz, it guarantees a sample rate of 32KHz.                                                                                                                                                                    |
|         BLDC motors |    6     | M0601C-111 BLDC motors from Direct Drive Tech. Connected to RaphaCore board via RS 485 bus.                                                                                                                                                                                                                                                                                                                     |
|           LED strip |    4     | 108 RGBW Individually addressable LEDs. <br /> 3535 form factor; 144/m, 23W/m. <br /> They serve as the rovers status indicator, but can be programmed for any custom behavior e.g. to work as a flashlight.                                                                                                                                                                                                    |

### Block diagram

<ThemedImageZoom
  alt="Hardware diagram of Rapha Rover"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-hardware-diagram-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-hardware-diagram-dark.webp',
    ),
  }}
  width="2000"
  height="1629"
  caption="Block diagram of Rapha Rovers hardware"
/>

### RaphaCore controller

RaphaCore serves as the primary control board for Rapha Rover, featuring a
robust STM32H5 series microcontroller. The board leverages FreeRTOS to
efficiently handle various low-level tasks integral to the functioning of Rapha
Rover. These tasks include:

- Drivetrain control
- Power system management
- LED control
- IMU operation
- Odometry tracking

<ThemedImageZoom
  alt="External connections of RaphaCore"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/raphaCore-diagram-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/raphaCore-diagram-dark.webp',
    ),
  }}
  width="2000"
  height="1375"
  caption="RaphaCore PCB connectors"
/>

### Drivetrain

The standard configuration of the Rapha Rover features a drivetrain comprising
two fixed wheels at the front and two rotary wheels at the rear. This design
enhances the mobility of the Rover, enabling it to execute precise maneuvers
such as:

- turning in place ( around middle point between frontal wheels)
- turning around specific frontal wheel
- turning around a curve

This versatile drivetrain configuration optimizes the Rover's navigational
capabilities, ensuring adaptability in various operational scenarios.

#### Motors

The Rapha Rover is equipped with 6 DirectDriveTech M0601C-111 direct-drive BLDC
motors, serving both the drive and turn functions. These motors enable the rover
to attain a speed of approximately 1.8 m/s when equipped with standard diameter
tires. Each motor is outfitted with an integrated incremental encoder with a
resolution of 12 bits.

To mitigate potential operational challenges, a mechanical bumper restricts the
turn angle of each steering wheel to 180°. This bumper not only acts as a limit
for wheel rotation but also serves to establish the wheel's position when the
rover is restarted, ensuring consistent and reliable performance.

#### Wheels

As standard, Rapha Rover comes with rubber tires with a diameter of about 170
mm. Whole drive assembly has following characteristics:

|                        Parameter |           Value           |
| -------------------------------: | :-----------------------: |
| Tire size (diameter x thickness) |    ~ 170 mm x ~ 80 mm     |
|                   Tire lock type |         Beadlock          |
|                      Tire insert | hard foam (non pneumatic) |
|               Wheel rim diameter |          120 mm           |

### Battery & charging

Rapha Rover boasts an advanced battery management system, a feature enabling the
simultaneous utilization of two battery packs. This innovative system empowers
the rover to seamlessly operate for approximately four continuous hours under
decent conditions (e.g. relatively flat terrain). The dual-battery configuration
enhances the overall endurance and sustained performance of the rover.

A notable feature of the design is the ability to detach the battery packs
without requiring a power-off cycle. By connecting the charger to the rear slot
of the Rover, users can safely remove both batteries. This functionality
streamlines the process of swift and efficient battery replacements, resulting
in minimal downtime during operations. The seamless swapping of battery packs
not only extends the operational range of the rover but also mitigates the
necessity for frequent service stops, thereby elevating the overall efficiency
and productivity of the robotic platform.

Each battery pack has following characteristics:

|            Parameter |                  Value                   |
| -------------------: | :--------------------------------------: |
|              Voltage |             22.2 V (nominal)             |
|         Battery type |                  Li-Ion                  |
|             Capacity |        4 Ah (96 Wh - flight safe)        |
|    Battery pack type |                   6S1P                   |
| Maximum output power |                  ~650 W                  |
|       Safety systems | Overcurrent, Reverse polarity protection |

#### Battery charging

By default Rapha Rover comes with 2A 25,2V Li-Ion charger. It can charge 1
battery pack in about 2,5 hours.

Rapha Rover has 2 options for charging batteries:

- Outside the Rover, by plugging battery into charger
- Inside the Rover, by plugging charger directly into rear charging slot of the
  Rover

The charger is outfitted with an LED status indicator designed to provide
information about the charging status of the battery. A green LED signifies that
the battery has reached full charge, while a red LED indicates that the battery
is currently in the charging process.

:::note

When charging the batteries with the Rover powered on, the LED indicator will
not transition to green during the charging cycle. This is due to the fact that
the charger will be used to sustain the operational state of the rover after the
charging process.

:::

### Payload specification

Rapha Rover is designed to be used with custom payloads. Main mounting plate is
located at the top of the rover and has following characteristics:

|                                  Parameter |                                                  Value                                                   |
| -----------------------------------------: | :------------------------------------------------------------------------------------------------------: |
|                           Payload capacity |                                                  ~10 kg                                                  |
|                          Hole grid spacing |                                              25 mm x 25 mm                                               |
|                   Mounting hole dimensions | 5.4 mm, compatible with: <br /> M5 screws <br/> CLS-M4-1 press-in nuts [example](https://mou.sr/3VyUg39) |
| Main mounting plate dimensions (L x W x D) |                                         330 mm x 198 mm x 2 mm\*                                         |

\* - actual maximum payload length is lower due to Lidar mounted at the front of
the plate and buttons at the rear.

<ThemedImageZoom
  alt="Rapha Rover's mounting plate dimensions"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-top-cover-dimensions-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-top-cover-dimensions-dark.webp',
    ),
  }}
  width="1500"
  height="2000"
  figStyle={{
    width: 600,
  }}
  caption="Main mounting plate dimensions"
/>

Apart from the mounting plate, it is possible to mount payloads directly to
v-slot extrusions of the Rapha Rover.

#### Rover's external ports

Rapha Rover has a special rear compartment provided as easy access to connect
many payloads. As default provided are following interfaces:

| Interface  |                        Notes                         |
| :--------: | :--------------------------------------------------: |
| USB type A | USB 3.2 Gen 2x1 (10 Gb/s), connected to UPBoard 7000 |
| USB type C | USB 3.2 Gen 2x1 (10 Gb/s), connected to UPBoard 7000 |
|   RJ-45    |   10/100/1000 Mbps, connected to Teltonika RUTX10    |

In addition, the rear compartment also includes a power panel with 3 sections,
each with different voltage levels. Each section can be individually controlled
by RaphaCore. Voltages available on power panel are:

|    Voltage    |  Max power  |                                                                               Connector                                                                               |
| :-----------: | :---------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|      5 V      | 2 A (10 W)  |  Phoenix Contact MC 1,5/ 2-ST-3,5 <br /> [example](https://www.tme.eu/en/details/mc1.5_2-st-3.5/pluggable-terminal-blocks/phoenix-contact/mc-1-5-2-st-3-5-1840366/)   |
|     12 V      | 2 A (24 W)  | Phoenix Contact MC 1,5/ 2-ST-3,81 <br /> [example](https://www.tme.eu/en/details/mc1.5_2-st-3.81/pluggable-terminal-blocks/phoenix-contact/mc-1-5-2-st-3-81-1803578/) |
| BAT (20-25 V) | 5 A (120 W) |       Phoenix Contact MSTB 2,5/ 2-ST-5,08 <br /> [example](https://www.tme.eu/en/details/mstb2.5_2-st-5.08/pluggable-terminal-blocks/phoenix-contact/1757019/)        |

<ThemedImageZoom
  alt="Rapha Rover's rear compartment overview"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-rear-compartment-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-rear-compartment-dark.webp',
    ),
  }}
  width="2000"
  height="1825"
  caption="Rear compartment overview"
/>

To ensure weather-tightness while accommodating additional payloads, the Rapha
Rover is equipped with specialized cable seals. To insert additional cables, it
is necessary to dismantle the entire panel by loosening two thumb screws. Once
the panel is disassembled, individual seals can be removed from the frame,
allowing for the insertion of new cables.

Rapha Rover comes with different seals, labeled as QT [Z]/[X] or QT [X], where Z
indicates the number of holes in the seal and X indicates the diameter of the
cable in millimeters.

<ThemedImageZoom
  alt="Rapha Rover's payload cable seals"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-cable-seals-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-cable-seals-dark.webp',
    ),
  }}
  width="2000"
  height="2000"
  figStyle={{
    width: 500,
  }}
  caption="Payload cable seal"
/>

#### Additional mounting plates

Beyond the primary mounting plate, the Rapha Rover offers the capability for
integration with supplementary mounting plates as needed. These additional
plates are colloquially known as "sandwich plates" due to their placement above
the main mounting plate. This design ensures that a payload affixed to the Rover
does not impede the Lidar's line of sight.

To install these additional mounting plates, begin by removing the bolts
securing the main mounting plate. Subsequently, affix the M5 x 25 standoffs
(provided with the Rover), in place of the removed bolts. Following this step,
place the mounting plate onto the standoffs and secure it in position by
fastening it with the screws that were initially holding the main mounting plate
in place.

:::tip

Holes on additional mounting plates exactly match ones located on the main
mounting plate.

:::

| Parameter                                                 |                                                   Value                                                   |
| :-------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------: |
| Additional mounting plate dimensions (L x W x D)          |                                         300.8 mm x 230 mm x 2 mm                                          |
| Additional extended mounting plate dimensions (L x W x D) |                                         350.8 mm x 380 mm x 2 mm                                          |
| Hole grid spacing                                         |                                               25 mm x 25 mm                                               |
| Mounting hole dimensions                                  | 5.4 mm, compatible with: <br /> M5 screws <br /> CLS-M4-1 press-in nuts [example](https://mou.sr/3VyUg39) |

<ThemedImageZoom
  alt="Rapha Rover's additional mounting plates dimensions"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/mounting-plates-dimensions-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/mounting-plates-dimensions-dark.webp',
    ),
  }}
  width="2000"
  height="1137"
  caption="Additional mounting plates dimensions"
/>

## Software specification

### Overview

Rapha Rover's software heavily relies on The
[Robot Operating System (ROS)](https://ros.org/) which offers the robot the
following functionalities:

- Abstraction layer facilitating communication between software components.
- Open-source software components, maintained by the community.
- A collection of standard message interfaces.
- Tools for introspection.

The primary segment of the software stack is partitioned into several
[ROS Nodes](https://wiki.ros.org/Nodes), treated as computational units, each
doing one logical thing. The nodes interact via:

- **Topics** - Named buses enabling message exchange between nodes. They are
  strongly typed and employ anonymous publish/subscribe semantics.
- **Services** - A client/server mechanism for remote procedure calls between
  nodes. The service server accepts remote procedure requests identified by name
  and type, which must be known to the service client beforehand.
- **Parameters** - Sets of key/value pairs maintained separately by each node,
  utilized for node configuration during startup and runtime without
  necessitating code modifications.
- **TF transforms** - A single transform describes the relationship between 2
  coordinate frames at a specific point in time. TF transforms are distributed
  between nodes using topics, but, for the sake of clarity, we will refer to
  them as separate entities.

There are two important software components which don't run as native ROS nodes:

- **Controller firmware** - The firmware itself acts as a ROS node but uses
  eProsima's
  [Micro XRCE-DDS](https://micro-xrce-dds.docs.eprosima.com/en/latest/) as its
  middleware. Thus, it requires the presence of the Micro-ROS Agent on the
  built-in computer to communicate with other ROS nodes.
- **Web User Interface** - The WebUI establishes a connection with the Rosbridge
  Server via WebSocket transport layer and employs the rosbridge protocol for
  communication with the ROS nodes.

<ThemedImageZoom
  alt="Overview of Rapha Rover's software components"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-software-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-software-dark.webp',
    ),
  }}
  width="2000"
  height="819"
  caption="Overview of the software components"
/>

### ROS nodes

<table>
  <thead>
    <tr>
      <th style={{ textAlign: 'right' }}>ROS Node</th>
      <th style={{ textAlign: 'left' }}>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Controller Node</td>
      <td>
        The node spawned by the Controller firmware. Provides access to functionalities
        via topics and services for the management of the drivetrain, LED panels, Power
        System and many more. Additionally, it publishes relevant information,
        including:

        - State of the dynamic joints controlled by RaphaCore.
        - Data retrieved from the onboard IMU sensor.
        - Power system status, comprising:
          - Battery voltages.
          - Connection status of batteries or the charger to the robot.
          - Current output power.
        - Computed odometry.
        - Diagnostic information for various system components.
      </td>
    </tr>
    <tr>
      <td>Robot State Publisher</td>
      <td>
        Parses the kinematic tree model of the robot in URDF format and broadcasts the
        robot state using TF transforms. Here's how it operates:

        - Fixed joints, like sensor positions, are published as static transforms.
        - Movable joints, such as wheel states, are published as dynamic transforms,
          based on the current joint states published by the Controller Node.

        It also publishes the robot URDF description on a designated topic, making it
        easily accessible to other nodes.
      </td>
    </tr>
    <tr>
      <td>Camera Driver</td>
      <td>
        Publishes the data provided by the stereoscopic camera. In the default
        configuration used in Rapha Rover, it includes:

        - Images captured by the left, right and RGB (center) camera image sensors.
        - Calibration parameters for each image sensor.
        - Data from the camera's IMU sensor.
        - Depth images computed from the left and right sensors.
      </td>
    </tr>
    <tr>
      <td>Depth Processing Node</td>
      <td>
        Publishes point cloud data computed from depth images and camera calibration
        parameters.

        Employs “lazy subscription”, meaning it refrains from processing any depth
        images until at least one node subscribes to the Point Cloud topic.
      </td>
    </tr>
    <tr>
      <td>LIDAR Driver</td>
      <td>
        Publishes data from the LIDAR sensor.

        Additionally, it provides services for starting and stopping the sensor's motor.
      </td>
    </tr>

  </tbody>
</table>

<ThemedImageZoom
  alt="Simplified graph of core ROS nodes running on Rapha Rover"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-ros-nodes-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-ros-nodes-dark.webp',
    ),
  }}
  width="2000"
  height="856"
  caption="Simplified graph of core ROS nodes running on Rapha Rover"
/>

Different robot applications will require running different sets of additional
nodes on top of the core ones. For example, consider a situation where we want
to autonomously drive to predefined coordinates in an unknown terrain. Typical
solution can be simplified to 2 nodes:

- SLAM (Simultaneous localization and mapping) node - generates a 2D terrain map
  and localizes the robot within it.
- Autonomous Navigation node - Retrieves navigation goals and outputs drive
  commands for the controller. Uses 2D terrain map to plan an optimized path and
  data from LiDAR and stereo camera to detect dynamic obstacles.

<ThemedImageZoom
  alt="ROS computation graph of an example autonomous navigation software"
  sources={{
    light: useBaseUrl(
      '/img/robots/rapha/specification/rapha-example-autonomous-navigation-light.webp',
    ),
    dark: useBaseUrl(
      '/img/robots/rapha/specification/rapha-example-autonomous-navigation-dark.webp',
    ),
  }}
  width="2000"
  height="634"
  caption="ROS computation graph of an example autonomous navigation software"
/>

These nodes can be configured to start alongside the core ones, extending the
robot with autonomous navigation capabilities.

### ROS API

:::warning
The ROS API in the beta version is subject to changes.
:::

#### Subscribed topics

- `controller/cmd_ackermann` ([ackermann_msgs/msg/AckermannDrive]) ?
- `controller/cmd_vel` ([geometry_msgs/msg/Twist])
- `controller/cmd_turn_in_place` ?
- `controller/led_strip_state` ([rapha_interfaces/msg/LedStripState])
- `controller/led_panel_state` ([rapha_interfaces/msg/LedPanelState])

#### Published Topics

- `controller/imu` ([sensor_msgs/msg/Imu])
- `controller/odom` ([nav_msgs/msg/Odometry])
- `controller/steering_mode` ([rapha_interfaces/msg/SteeringMode])
    transient local qos
- `controller/diagnostics/imu` ([rapha_interfaces/msg/ImuDiagnostics])
  - IMU temperature,
- `controller/diagnostics/motors` ([rapha_interfaces/msg/MotorDiagnostics])
  - motor temperatures,
  - motor power (current?),
  - motor energy,
  - motor faults,
- `controller/power_system_state` ([rapha_interfaces/msg/PowerSystemState])
  - is charger connected?
  - are batteries connected?
  - battery states
    - voltage [V]
    - state_of_charge [%]
    - target and current mode
      - is charging?
      - is drained?
  - output power [W]
  - consumed energy [Wh]
- `joint_states` ([sensor_msgs/msg/JointState])
- `/rosout` ([rcl_interfaces/msg/Log]) ?
- `/tf` ([tf2_msgs/msg/TFMessage])

#### Services

- `controller/clear_leds` ([std_srvs/srv/Trigger])
- `controller/set_leds` ([rapha_interfaces/srv/SetLeds])
- `controller/calibrate_servos` ([std_srvs/srv/Trigger])
- `controller/reset_odom` ([std_srvs/srv/Trigger])
- `controller/reset_motor_diagnostics` ([std_srvs/srv/Trigger])
- `controller/set_battery_modes` ([rapha_interfaces/srv/SetBatteryModes])
  - bat1 charging, bat2 charging
  - bat1 draining, bat2 draining
- `controller/set_steering_mode` ([rapha_interfaces/srv/SetSteeringMode])
  - Ackermann
  - Turn in-place

#### Custom message types

{/* TODO: Remove this section after rapha_interfaces message definitions start being hosted in docs.ros2.org */}

##### rapha_interfaces/msg/SteeringMode

<a id="msg-steering-mode">
```bash title="Represents the steering mode used by the drivetrain controller."
uint8 ACKERMANN=0
uint8 TURN_IN_PLACE=1

uint8 data
```
</a>

##### rapha_interfaces/msg/BatteryMode

<a id="msg-battery-mode">
```bash title="Represents the target or actual battery power mode."
bool charging
bool draining
```
</a>

##### rapha_interfaces/msg/BatteryState

<a id="msg-battery-state">
```bash title="Represents the state of a single battery."
# The current voltage in volts
float64 voltage

# Estimated state of charge in percents
float64 state_of_charge

# The target battery mode
rapha_interfaces/BatteryMode target_mode

# The actual battery mode
rapha_interfaces/BatteryMode current_mode
```
</a>

##### rapha_interfaces/msg/PowerSystemState

<a id="msg-power-system-state">
```bash title="Represents the state of the Power System."
std_msgs/Header header

# Whether the charger is connected
bool charger_connected

# Whether the batteries are connected
bool bat1_connected
bool bat2_connected

# The states of the batteries, not valid for unconnected batteries
rapha_interfaces/BatteryState bat1_state
rapha_interfaces/BatteryState bat2_state

# The current power output in watts
float64 power

# The energy consumed in watt-hours since the robot was powered on
float64 energy
```
</a>

##### rapha_interfaces/msg/LedColor

<a id="msg-led-color">
```bash title="Represents the color of an LED."
# The intensity of each color (255 = 100%)
uint8 red
uint8 green
uint8 blue
uint8 white
```
</a>

##### rapha_interfaces/msg/LedPanel

<a id="msg-led-panel">
```bash title="Enumeration of robot's LED panels."
uint8 FRONT=0
uint8 BACK=1
uint8 LEFT=2
uint8 RIGHT=3

uint8 data
```
</a>

##### rapha_interfaces/msg/LedState

<a id="msg-led-state">
```bash title="Represents the state of a single LED."
# The duration (in ms) the state should be active
uint16 duration

# The priority of the state. The state with the highest priority is displayed
# The value of -1 resets the user state of the LED
int8 priority

# The color of the LED
rapha_interfaces/LedColor color
```
</a>

##### rapha_interfaces/msg/LedPanelState

<a id="msg-led-panel-state">
```bash title="Represents the state of the whole LED panel."
rapha_interfaces/LedPanel panel
rapha_interfaces/LedState[36] state
```
</a>

##### rapha_interfaces/msg/LedStripState

<a id="msg-led-strip-state">
```bash title="Represents the state of the whole LED strip."
uint8 LED_STRIP_SIZE=129
rapha_interfaces/LedState[129] state
```
</a>

##### rapha_interfaces/msg/Led

<a id="msg-led">
```bash title="Represents the position and the state of the LED."
# 
rapha_interfaces/LedPanel panel

# The id of the LED on the panel
uint8 id

# 
rapha_interfaces/LedState state
```
</a>

##### rapha_interfaces/msg/MotorDiagnostics

<a id="msg-motor-diagnostics">
```bash title="Diagnostic information about motors controlled by RaphaCore."
# The order of the motors is:
#   - rear left wheel
#   - rear right wheel
#   - right servo
#   - left servo
#   - front left wheel
#   - front right wheel

std_msgs/Header header

# The current temperature in degrees Celcius
uint8[6] temperature

# The current power output in watts
float64[6] power

# The energy consumed in watt-hours since the robot was powered on
float64[6] energy

uint8 FAULT_BIT_SENSOR_FAULT=1
uint8 FAULT_BIT_BUS_OVERCURRENT=2
uint8 FAULT_BIT_PHASE_OVERCURRENT=4
uint8 FAULT_BIT_STALL=8
uint8 FAULT_BIT_OVERHEAT=16

# The current fault mask reported by the motor
uint8[6] fault_mask_active

# Mask of all fault that occured since the robot was powered on
uint8[6] fault_mask_occured
```
</a>


##### rapha_interfaces/msg/ImuDiagnostics

<a id="msg-imu-diagnostics">
```bash title="Diagnostic information about IMU sensor running on RaphaCore."
std_msgs/Header header

# The current temperature of the sensor in degrees Celcius
float64 temperature

# The current gyroscope biases
float64 gyro_bias_x
float64 gyro_bias_y
float64 gyro_bias_z
```
</a>

#### Custom service types

{/* TODO: Remove this section after rapha_interfaces message definitions start being hosted in docs.ros2.org */}

##### rapha_interfaces/srv/SetSteeringMode

<a id="srv-set-steering-mode">
```bash
rapha_interfaces/SteeringMode steering_mode
---
bool success
string status_message
```
</a>

##### rapha_interfaces/srv/SetBatteryModes

<a id="srv-set-battery-modes">
```bash
rapha_interfaces/BatteryMode bat1_mode
rapha_interfaces/BatteryMode bat2_mode
---
bool success
string status_message
```
</a>

##### rapha_interfaces/srv/SetLeds

<a id="srv-set-leds">
```bash
rapha_interfaces/Led[<=129] leds
---
bool success
string status_message
```
</a>


[ackermann_msgs/msg/AckermannDrive]: https://github.com/ros-drivers/ackermann_msgs/blob/ros2/msg/AckermannDrive.msg
[geometry_msgs/msg/Twist]: https://docs.ros2.org/latest/api/geometry_msgs/msg/Twist.html
[nav_msgs/msg/Odometry]: https://docs.ros2.org/latest/api/nav_msgs/msg/Odometry.html
[rcl_interfaces/msg/Log]: https://docs.ros2.org/latest/api/rcl_interfaces/msg/Log.html
[sensor_msgs/msg/JointState]: https://docs.ros2.org/latest/api/sensor_msgs/msg/JointState.html
[sensor_msgs/msg/Imu]: https://docs.ros2.org/latest/api/sensor_msgs/msg/Imu.html
[std_srvs/srv/Trigger]: https://docs.ros2.org/latest/api/std_srvs/srv/Trigger.html
[tf2_msgs/msg/TFMessage]: https://docs.ros2.org/latest/api/tf2_msgs/msg/TFMessage.html

[rapha_interfaces/msg/BatteryMode]: #msg-battery-mode
[rapha_interfaces/msg/BatteryState]: #msg-battery-state
[rapha_interfaces/msg/ImuDiagnostics]: #msg-imu-diagnostics
[rapha_interfaces/msg/Led]: #msg-led
[rapha_interfaces/msg/LedColor]: #msg-led-color
[rapha_interfaces/msg/LedPanel]: #msg-led-panel
[rapha_interfaces/msg/LedPanelState]: #msg-led-panel-state
[rapha_interfaces/msg/LedState]: #msg-led-state
[rapha_interfaces/msg/LedStripState]: #msg-led-strip-state
[rapha_interfaces/msg/MotorDiagnostics]: #msg-motor-diagnostics
[rapha_interfaces/msg/PowerSystemState]: #msg-power-system-state
[rapha_interfaces/msg/SteeringMode]: #msg-steering-mode

[rapha_interfaces/srv/SetBatteryModes]: #srv-set-battery-modes
[rapha_interfaces/srv/SetLeds]: #srv-set-leds
[rapha_interfaces/srv/SetSteeringMode]: #srv-set-steering-mode

### Firmware

{/* TODO */}

_Work in progress_

#### LED controller

The built-in LED controller manages the LED states of the robot by processing
user-defined states and animations, integrating them with ongoing animations,
and updating the LEDs accordingly.

Users can control the LED strip by specifying colors, duration, and priority of
specific LEDs. This allows for in-depth control, enabling users to determine
which LED states are the most important. Critical states, such as errors, are
displayed over less important uses, like illuminating the surroundings.

The robot features four LED panels that combine to form one long LED strip. LEDs
can be controlled either as a full strip or as specific panels, providing
flexibility for different use cases:

- **Full Strip Control**: Ideal for animations that span the entire perimeter of
  the robot, such as police lights.
- **Panel-Specific Control**: Useful for targeted functions, such as using all
  front LEDs as a flashlight or using side LEDs to indicate battery levels.

#### Robot status Indicators descriptions

##### Normal states

{/* prettier-ignore */}
<table>
  <thead>
    <tr>
      <th style={{ textAlign: 'center' }}>LED</th>
      <th style={{ textAlign: 'center' }}>LED description</th>
      <th style={{ textAlign: 'left' }}>State description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.flashWhite}/></td>
      <td style={{ textAlign: 'center' }}>White, flashing</td>
      <td style={{ textAlign: 'left' }}>Robot booting up*</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.breathWhite}/></td>
      <td style={{ textAlign: 'center' }}>White, breathing</td>
      <td style={{ textAlign: 'left' }}>Idle, rover on, motors relaxed*</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.white}/></td>
      <td style={{ textAlign: 'center' }}>White, constant</td>
      <td style={{ textAlign: 'left' }}>Rover on, motors relaxed*</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.breathBlue}/></td>
      <td style={{ textAlign: 'center' }}>Blue, breathing</td>
      <td style={{ textAlign: 'left' }}>Turning wheels not calibrated*</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.blue}/></td>
      <td style={{ textAlign: 'center' }}>Blue, constant</td>
      <td style={{ textAlign: 'left' }}>Turning wheels calibration</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.yellow}/></td>
      <td style={{ textAlign: 'center' }}>Yellow, constant</td>
      <td style={{ textAlign: 'left' }}>Maintenance mode</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.green}/></td>
      <td style={{ textAlign: 'center' }}>Green, constant - side panels</td>
      <td style={{ textAlign: 'left' }}>Battery charge indicator</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.breathGreen}/></td>
      <td style={{ textAlign: 'center' }}>Green, breathing - side panels</td>
      <td style={{ textAlign: 'left' }}>Battery charging indicator, turns solid when fully charged*</td>
    </tr>
  </tbody>
</table>

##### Fault states

{/* prettier-ignore */}
<table>
  <thead>
    <tr>
      <th style={{ textAlign: 'center' }}>LED</th>
      <th style={{ textAlign: 'center' }}>LED description</th>
      <th style={{ textAlign: 'left' }}>State description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.flashRed}/></td>
      <td style={{ textAlign: 'center' }}>Red, flashing</td>
      <td style={{ textAlign: 'left' }}>Rover error detected*</td>
    </tr>
    <tr>
      <td style={{ textAlign: 'center' }} className={styles.LEDcell}><span className={styles.circle} id={styles.flashRed3}/></td>
      <td style={{ textAlign: 'center' }}>Red, 3 fast flashes</td>
      <td style={{ textAlign: 'left' }}>Multiple errors detected*</td>
    </tr>
  </tbody>
</table>

\* - not implemented currently

### Web User Interface

The beta version of the Rapha rover does not feature a User Interface (UI). The
software is fully operational in terms of functionality; however, the absence of
a UI necessitates interaction through Command Line Interface (CLI) or other
programming methods.

### Network

_Work in progress_

{/* TODO */}
